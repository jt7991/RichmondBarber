---
const { src, alt, id, index } = Astro.props;
---

<div id={`${id}-checker`}>
  <img
    src={src}
    alt={alt}
    loading="lazy"
    class={`w-full h-full aspect-square object-cover rounded-lg shadow-lg transform transition-all duration-300 opacity-0  -translate-x-11/12 ${index % 2 ? "delay-200" : ""}`}
    id={id}
  />
</div>

<script define:vars={{ id }} is:inline>
  const imgElem = document.getElementById(id);
  const imgChecker = document.getElementById(`${id}-checker`);

  if (imgChecker) {
    const observer = new IntersectionObserver(
      (entries) => {
        for (const entry of entries) {
          if (entry.isIntersecting) {
            imgElem.classList.add("!translate-x-0");
            imgElem.classList.add("!opacity-100");
          } else {
            imgElem.classList.remove("!translate-x-0");
            imgElem.classList.remove("!opacity-100");
          }
        }
      },
      { rootMargin: "-100px" },
    );
    observer.observe(imgChecker);
  }
</script>
